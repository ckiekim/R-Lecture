devtools::install_github("cardiomoon/kormaps2014")
library(kormaps2014)
# 대한민국 시도별 인구 데이터 준비하기
str(changeCode(korpop1))
library(dplyr)
korpop1 <- rename(korpop1,
pop = 총인구_명,
name = 행정구역별_읍면동)
str(changeCode(kormap1))
head(changeCode(kormap1))
# 단계 구분도 만들기
library(ggplot2)
ggChoropleth(data = korpop1,       # 지도에 표현할 데이터
aes(fill = pop,       # 색깔로 표현할 변수
map_id = code,    # 지역 기준 변수
tooltip = name),  # 지도 위에 표시할 지역명
map = kormap1,        # 지도 데이터
interactive = T)        # 인터랙티브
library(ggiraphExtra)
ggChoropleth(data = korpop1,       # 지도에 표현할 데이터
aes(fill = pop,       # 색깔로 표현할 변수
map_id = code,    # 지역 기준 변수
tooltip = name),  # 지도 위에 표시할 지역명
map = kormap1,        # 지도 데이터
interactive = T)        # 인터랙티브
# 대한민국 시도별 결핵 환자 수 단계 구분도 만들기
str(changeCode(tbc))
ggChoropleth(data = tbc,           # 지도에 표현할 데이터
aes(fill = NewPts,    # 색깔로 표현할 변수
map_id = code,    # 지역 기준 변수
tooltip = name),  # 지도 위에 표시할 지역명
map = kormap1,        # 지도 데이터
interactive = T)      # 인터랙티브
ggChoropleth(data = tbc,           # 지도에 표현할 데이터
aes(fill = NewPts,    # 색깔로 표현할 변수
map_id = code,    # 지역 기준 변수
tooltip = name),  # 지도 위에 표시할 지역명
map = kormap1)        # 지도 데이터
ggChoropleth(data = tbc,           # 지도에 표현할 데이터
aes(fill = NewPts,    # 색깔로 표현할 변수
map_id = code,    # 지역 기준 변수
tooltip = name),  # 지도 위에 표시할 지역명
map = kormap1) +      # 지도 데이터
#interactive = T)      #
ggtitle("시도별 결핵 환자 수") +
xlab("경도") +
ylab("위도") +
theme(plot.title = element_text(face = "bold", hjust = 0.5,
size = 15, color = "darkblue"))
library(extrafont)
windowsFonts(malgun = "맑은 고딕")
theme_update(text = element_text(family = "malgun"))
ggChoropleth(data = tbc,           # 지도에 표현할 데이터
aes(fill = NewPts,    # 색깔로 표현할 변수
map_id = code,    # 지역 기준 변수
tooltip = name),  # 지도 위에 표시할 지역명
map = kormap1) +      # 지도 데이터
#interactive = T)      #
ggtitle("시도별 결핵 환자 수") +
xlab("경도") +
ylab("위도") +
theme(plot.title = element_text(face = "bold", hjust = 0.5,
size = 15, color = "darkblue"))
tbc <- tbc %>%
rename(결핵환자수 = NewPts)
ggChoropleth(data = tbc,           # 지도에 표현할 데이터
aes(fill = 결핵환자수,    # 색깔로 표현할 변수
map_id = code,    # 지역 기준 변수
tooltip = name),  # 지도 위에 표시할 지역명
map = kormap1) +      # 지도 데이터
#interactive = T)      #
ggtitle("시도별 결핵 환자 수") +
xlab("경도") +
ylab("위도") +
theme(plot.title = element_text(face = "bold", hjust = 0.5,
size = 15, color = "darkblue"))
ggChoropleth(data = tbc,             # 지도에 표현할 데이터
aes(fill = 결핵환자수,  # 색깔로 표현할 변수
map_id = code,      # 지역 기준 변수
tooltip = name),    # 지도 위에 표시할 지역명
map = kormap1,          # 지도 데이터
interactive = T) +      # 인터랙티브
ggtitle("시도별 결핵 환자 수") +
xlab("경도") +
ylab("위도") +
theme(plot.title = element_text(face = "bold", hjust = 0.5,
size = 15, color = "darkblue"))
tbc <- tbc %>%
rename(결핵환자수 = NewPts)
ggChoropleth(data = tbc,             # 지도에 표현할 데이터
aes(fill = 결핵환자수,  # 색깔로 표현할 변수
map_id = code,      # 지역 기준 변수
tooltip = name),    # 지도 위에 표시할 지역명
map = kormap1,          # 지도 데이터
interactive = T) +      # 인터랙티브
ggtitle("시도별 결핵 환자 수") +
xlab("경도") +
ylab("위도") +
theme(plot.title = element_text(face = "bold", hjust = 0.5,
size = 15, color = "darkblue"))
# 대한민국 시도별 결핵 환자 수 단계 구분도 만들기
str(changeCode(tbc))
library(kormaps2014)
# 대한민국 시도별 인구 데이터 준비하기
str(changeCode(korpop1))
korpop1 <- rename(korpop1,
pop = 총인구_명,
name = 행정구역별_읍면동)
# 대한민국 시도별 결핵 환자 수 단계 구분도 만들기
str(changeCode(tbc))
# 대한민국 시도별 결핵 환자 수 단계 구분도 만들기
str(changeCode(tbc))
ggChoropleth(data = tbc,             # 지도에 표현할 데이터
aes(fill = NewPts,  # 색깔로 표현할 변수
map_id = code,      # 지역 기준 변수
tooltip = name),    # 지도 위에 표시할 지역명
map = kormap1,          # 지도 데이터
interactive = T)        # 인터랙티브
new_tbc <- tbc %>%
rename(결핵환자수 = NewPts)
ggChoropleth(data = new_tbc,         # 지도에 표현할 데이터
aes(fill = 결핵환자수,  # 색깔로 표현할 변수
map_id = code,      # 지역 기준 변수
tooltip = name),    # 지도 위에 표시할 지역명
map = kormap1) +         # 지도 데이터
ggtitle("시도별 결핵 환자 수") +
xlab("경도") +
ylab("위도") +
theme(plot.title = element_text(face = "bold", hjust = 0.5,
size = 15, color = "darkblue"))
# 예제 5-1. WorldBank 자료로 움직이는 버블챠트 생성하기
library(googleVis)
demo(WorldBank)
demo(WorldBank)
# 예제 5-2. 그래프가 살아있다 2 - 실습으로 확인하기
Fruits
Fruits1<- gvisMotionChart(Fruits, idvar="Fruit", timevar="Year")
plot(Fruits1)
# 예제 5-1. WorldBank 자료로 움직이는 버블챠트 생성하기
library(googleVis)
# 예제 5-2. 그래프가 살아있다 2 - 실습으로 확인하기
Fruits
Fruits1<- gvisMotionChart(Fruits, idvar="Fruit", timevar="Year")
plot(Fruits1)       # 동작하지 않음
setwd('D:/Workspace/R_Data_Analysis/Part2/Stage5_GoogleChart')
# 예제 5-3 . 서울 지하철 1,2,3,4 호선 이용승객현황 출력하기
line <- read.csv("1-4호선승하차승객수.csv",header=T,sep=",")
line
t1 <- gvisMotionChart(line, idvar="line_no", timevar="time",
options=list(width=1000,height=500))
t1 <- gvisMotionChart(line, idvar="노선번호", timevar="시간",
options=list(width=1000,height=500))
plot(t1)
# 예제 5-3 . 서울 지하철 1,2,3,4 호선 이용승객현황 출력하기
line <- read.csv("1-4호선승하차승객수.csv",header=T,sep=",")
line
t1 <- gvisMotionChart(line, idvar="노선번호", timevar="시간",
options=list(width=1000,height=500))
plot(t1)
# 예제 5-6. Googlemap 좋아요
data(Andrew)
Andrew
storm1 <- gvisMap(Andrew, "LatLong" , "Tip",
options=list(showTip=TRUE, showLine=TRUE, enableScrollWheel=TRUE,
mapType='hybrid', useMapTypeControl=TRUE,
width=800,height=400))
plot(storm1)
# 예제 5-7 . Googlemap~서울시 구청 위치를 표시해 줘~
loc <- read.csv("서울시구청위치정보_new.csv",header=T)
loc
hoffice <- gvisMap(loc, "LATLON" , "name",
options=list(showTip=TRUE, showLine=TRUE,
enableScrollWheel=TRUE,
mapType='normal',
useMapTypeControl=TRUE,
width=1000,height=400))
plot(hoffice)
# 예제 5-8. Googlemap으로 제주도 여행지 위치 색다르게 보기
ft_placelst <- function(place) {
temp <- geocode(place) # 이부분이 핵심!! 위도 경도를 임시변수에 담습니다
place <- gsub("제주 ","",place)
df_lst <- cbind(place,temp) # 여행지이름 위도 경도'로 이루어진 데이터프레임
return(df_lst)
}
df_placelst <- ft_placelst(readLines("제주여행코스.txt"))
# 예제 5-8. Googlemap으로 제주도 여행지 위치 색다르게 보기
library(ggmap)
# 다양한 구글챠트 활용하기
install.packages('ggmap')
# 예제 5-8. Googlemap으로 제주도 여행지 위치 색다르게 보기
library(ggmap)
ft_placelst <- function(place) {
temp <- geocode(place) # 이부분이 핵심!! 위도 경도를 임시변수에 담습니다
place <- gsub("제주 ","",place)
df_lst <- cbind(place,temp) # 여행지이름 위도 경도'로 이루어진 데이터프레임
return(df_lst)
}
df_placelst <- ft_placelst(readLines("제주여행코스.txt"))
latlon <- paste(df_placelst$lat,":",df_placelst$lon)
df_placelst <- ft_placelst(readLines("제주여행코스.txt"))
latlon <- paste(df_placelst$lat,":",df_placelst$lon)
latlon <- gsub(" ","",latlong)
# 예제 5-9.  Google Gauge Chart 로 실적을 표시하기
CityPopularity
ex1 <-gvisGauge(CityPopularity,
options=list(min=0, max=800,
greenFrom=500, greenTo=800,
yellowFrom=300, yellowTo=500,
redFrom=0, redTo=300, width=400, height=300))
plot(ex1)
# 예제 5-10 . Google Line Chart 사용하기
fruits=data.frame(month=c("JAN","FEB","MAR"),
apple=c(30,10,20),
orange=c(20,40,30))
line <- gvisLineChart(fruits)
plot(line)
line2 <- gvisLineChart(fruits,"month",c("apple","orange"),
option=list(series="[{targetAxisIndex:0},{targetAxisIndex:1}]",
vAxes="[{title:'apple'},{title:'orange'}]" ))
plot(line2)
line3 <- gvisLineChart(fruits,xvar="month",yvar=c("apple","orange"),
options=list(series="[{color:'blue',targetAxisIndex:0,linewidth:1,lineDashStyle:[1,10,1,10,1,10]},{color:'red',targetAxisIndex:1,linewidth:2,lineDashStyle:[4,1]}]",
vAxes="[{title:'apple'},{title:'orange'}]" ))
plot(line3)
# 예제 5-11. Google Bar Chart 사용하기
gbar <- gvisBarChart(fruits)
plot(gbar)
# 예제 5-12. Google Pie Chart 사용하기
CityPopularity
pie1 <- gvisPieChart(CityPopularity,options=list(width=400, height=300))
plot(pie1)
# 도넛 차트 만들기
pie2 <- gvisPieChart(CityPopularity, options=list(
slices="{4: {offset: '0.2'}, 0: {offset: '0.3'}}",
title="City popularity",
legend="none",
pieSliceText="label",
pieHole="0.5",width=600))
plot(pie2)
# 예제 5-13. Google Candle Stick Chart 사용하기
OpenClose
candle <- gvisCandlestickChart(OpenClose,
options=list(legend='none',height=400,width=500))
plot(candle)
a <- gvisBubbleChart(Fruits, idvar="Fruit", xvar="Sales", yvar="Expenses",
colorvar="Year", sizevar="Profit",
options=list(height=500,weight=800,
+                                   hAxis='{minValue:75, maxValue:125}'))
# 예제 5-14. Google Bubble Chart 사용하기
Fruits
a <- gvisBubbleChart(Fruits, idvar="Fruit", xvar="Sales", yvar="Expenses",
colorvar="Year", sizevar="Profit",
options=list(height=500,weight=800,
+                                   hAxis='{minValue:75, maxValue:125}'))
a <- gvisBubbleChart(Fruits, idvar="Fruit", xvar="Sales", yvar="Expenses",
colorvar="Year", sizevar="Profit",
options=list(height=500,weight=800,
hAxis='{minValue:75, maxValue:125}'))
plot(a)
# 예제 5-15. Google Column Chart
korean <- read.csv("학생별회차별성적__국어_new.csv",header=T)
korean
kor <- gvisColumnChart(korean,options=list(title="학생별 성적비교",
height=400,weight=500))
plot(kor)
header <- kor$html$header
header <- gsub("charset:utf-8", "charset:euc-kr", header)
kor$html$header <- header
plot(kor)
kor <- gvisColumnChart(korean,options=list(title="학생별 성적비교",
height=400,weight=500))
header <- kor$html$header
header <- gsub("charset:utf-8", "charset:euc-kr", header)
kor$html$header <- header
plot(kor)
header <- kor$html$header
header <- gsub("charset=utf-8", "charset=euc-kr", header)
kor$html$header <- header
plot(kor)
area <- gvisAreaChart(korean,options=list(height=400,weight=500 ))
plot(area)
area <- gvisAreaChart(korean,options=list(height=400, weight=500))
header <- area$html$header
header <- gsub("charset=utf-8", "charset=euc-kr", header)
area$html$header <- header
plot(area)
# 예제 5-17. Google Combo Chart 사용하기
combo <- gvisComboChart(korean,options=list(seriesType="bars",
height=400,weight=500,
series='{3: {type:"line"}}'))
plot(combo)
header <- combo$html$header
header <- gsub("charset=utf-8", "charset=euc-kr", header)
combo$html$header <- header
plot(combo)
pemp <- c(NA,'Angela Bassett','Jessica Lange','Winona Ryder','Winona Ryder',
'Angela Bassett','Emma Thompson', 'Julia Roberts','Angela Bassett',
'Meryl Streep','Susan Sarandon')
pay <- c(100,200,300,400,500,600,700,800,900,1000,1100)
emp <- data.frame(NAME=name,PNAME=pemp, PAY=pay)
Org <- gvisOrgChart(emp,idvar="NAME",parentvar="PNAME",
options=list(width=600, height=250,size='middle', allowCollapse=TRUE))
emp <- data.frame(NAME=name,PNAME=pemp, PAY=pay)
# 예제 5-18. 계층도 그리기 - gvisOrgChart 사용하기
name <- c('Angela Bassett','Jessica Lange','Winona Ryder','Michelle Pfeiffer',
'Whoopi Goldberg','Emma Thompson','Julia Roberts','Sharon Stone','Meryl Streep',
'Susan Sarandon','Nicole Kidman')
pemp <- c(NA,'Angela Bassett','Jessica Lange','Winona Ryder','Winona Ryder',
'Angela Bassett','Emma Thompson', 'Julia Roberts','Angela Bassett',
'Meryl Streep','Susan Sarandon')
pay <- c(100,200,300,400,500,600,700,800,900,1000,1100)
emp <- data.frame(NAME=name,PNAME=pemp, PAY=pay)
Org <- gvisOrgChart(emp,idvar="NAME",parentvar="PNAME",
options=list(width=600, height=250,size='middle', allowCollapse=TRUE))
plot(Org)
# 예제 5-19. 챠트에 주석 넣기- gvisAnnotationChart 사용
Stock
achart <- gvisAnnotationChart(Stock,datevar="Date",numvar="Value",idvar="Device",
titlevar="Title",annotationvar="Annotation",
options=list(width=1000,height=500,fill=10, displayExactValues=TRUE,
+                         colors="['red','blue']"))
achart <- gvisAnnotationChart(Stock,datevar="Date",numvar="Value",idvar="Device",
titlevar="Title",annotationvar="Annotation",
options=list(width=1000,height=500,fill=10, displayExactValues=TRUE,
colors="['red','blue']"))
plot(achart)
# 예제 5-20. 웹에서 다운로드 받은 자료를 그래프로 출력하기
install.packages("httr")
install.packages("httr")
install.packages("XML")
# 예제 5-1. WorldBank 자료로 움직이는 버블챠트 생성하기
library(googleVis)
demo(WorldBank)       # 에러 발생
library(XML)
library(googleVis)
library("httr")
cafile <- system.file("CurlSSL", "cacert.pem", package = "RCurl")
page <- GET(
"https://en.wikipedia.org/",
path="wiki/World_population",
config(cainfo = cafile))
x <- content(page, as ='text')
tab <- sub('.*(<table class="grid".*?>.*</table>).*', '\\1', x)
pop_table <- readHTMLTable(tab)
length(pop_table)
pop_table
str(pop_table)
pop_table <- readHTMLTable(tab,which=1)  # 1번째 테이블입니다.
pop_table[c(1:28),]
pop2 <- pop_table[c(1:11),c(2:5)]
pop2
write.csv(pop2,'pop.csv')
pop_table[c(1:28),]
pop2 <- pop_table[c(1:11),c(2:5)]
#==============================================================
str(pop_table[c(1:28),])
