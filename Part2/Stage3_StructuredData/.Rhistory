install.packages("plotrix")
library(ggplot2)
library(dplyr)
setwd('d:/workspace/r_data_analysis/part2/stage2_graph/ex01_jeju')
library(KoNLP)
library(wordcloud)
myray_1 <- readLines("new_myray.txt")
myray_2 <- sapply(myray_1, extractNoun,USE.NAMES=F)
my_ray3 <- unlist(myray_2)
my_ray3 <- Filter(function(x) {nchar(x) >= 2} ,my_ray3)
my_ray3 <- gsub(" ","-",my_ray3)
my_ray3 <- gsub("교체","",my_ray3)
my_ray3 <- gsub("작동","",my_ray3)
my_ray3 <- gsub("교환","",my_ray3)
my_ray3 <- gsub("ㅠㅠ","",my_ray3)
my_ray3 <- gsub("\\d+","",my_ray3)
my_ray3 <- gsub("\\.","",my_ray3)
write(unlist(my_ray3),"myray_2.txt")
ray <- read.table("myray_2.txt")
wordcount <- table(ray)
my_ray4 <- head(sort(wordcount, decreasing=T),10)
colors <- c( )
for ( i in 1:length(my_ray4)) {
if (my_ray4[i] >= 10 ) {
colors <- c(colors,"red") }
else if (my_ray4[i] >= 6 ){
colors <- c(colors,"yellow") }
else {
colors <- c(colors,"green") }
}
bchart <- barplot(my_ray4,main="고객 불만 사항 상위 TOP 10", ylab="불만건수" ,
names.arg=names(my_ray4),col=colors,las=2 , ylim=c(0,13))
text(x = bchart, y = my_ray4*0.95, labels = paste(my_ray4,"건"), col = "black",
cex = 0.7)
pct <- round(my_ray4/sum(my_ray4) * 100 ,1)
text(x = bchart, y = my_ray4*1.05, labels = paste("(",pct,"%",")"), col = "black",
cex = 0.6)
abline(h=8,col="red",lty=2,lwd=1)
abline(h=5,col="black",lty=2,lwd=1)
head(wordcount,10)
my_ray4
for ( i in 1:length(my_ray4)) {
if (my_ray4[i] >= 8 ) {
colors <- c(colors,"red") }
else if (my_ray4[i] >= 6 ){
colors <- c(colors,"yellow") }
else {
colors <- c(colors,"green") }
}
bchart <- barplot(my_ray4,main="고객 불만 사항 상위 TOP 10", ylab="불만건수" ,
names.arg=names(my_ray4),col=colors,las=2 , ylim=c(0,13))
text(x = bchart, y = my_ray4*0.95, labels = paste(my_ray4,"건"), col = "black",
cex = 0.7)
pct <- round(my_ray4/sum(my_ray4) * 100 ,1)
text(x = bchart, y = my_ray4*1.05, labels = paste("(",pct,"%",")"), col = "black",
cex = 0.6)
abline(h=8,col="red",lty=2,lwd=1)
my_ray4
colors <- c( )
for ( i in 1:length(my_ray4)) {
if (my_ray4[i] >= 8 ) {
colors <- c(colors,"red") }
else if (my_ray4[i] >= 6 ){
colors <- c(colors,"yellow") }
else {
colors <- c(colors,"green") }
}
bchart <- barplot(my_ray4,main="고객 불만 사항 상위 TOP 10", ylab="불만건수" ,
names.arg=names(my_ray4),col=colors,las=2 , ylim=c(0,13))
my_ray5 <- head(sort(wordcount, decreasing=T),10)
colors <- c()
if (my_ray5[i] >= 8 ) {
colors <- c(colors,"red") }
for ( i in 1:length(my_ray5)) {
if (my_ray5[i] >= 8 ) {
colors <- c(colors,"red") }
else if (my_ray5[i] >= 6 ){
colors <- c(colors,"yellow") }
else {
colors <- c(colors,"green") }
}
lab <- paste(names(my_ray5),"\n",my_ray5,"건")
pie(my_ray5,main="고객 불만 사항 상위 Top 10",col=colors,
cex=0.8,labels = lab)
setwd('d:/workspace/r_data_analysis/part2/stage3_StructuredData')
('d:/workspace/r_data_analysis/part2/stage3_StructuredData')
('d:/workspace/r_data_analysis/part2/stage3_StructuredData')
data1 <- read.csv("2013년_서울_주요구별_병원현황.csv" , header=T)
data1 <- read.csv("2013년_서울_주요구별_병원현황.csv" , header=T)
data1
barplot(as.matrix(data1[1:9,2:11]),
main=paste("서울시 주요 구별 과목별 병원현황-2013년","\n",
"출처[국민건강보험공단]") , ylab="병원수", beside=T ,
col=rainbow(8),ylim=c(0,350))
data1 <- read.csv("2013년_서울_주요구별_병원현황.csv" , header=T)
data1
barplot(as.matrix(data1[1:9,2:11]),
main=paste("서울시 주요 구별 과목별 병원현황-2013년","\n",
"출처[국민건강보험공단]") , ylab="병원수", beside=T ,
col=rainbow(8),ylim=c(0,350))
abline(h=seq(0,350,10),lty=3,lwd=0.2)
name <- data1$표시과목
name
legend(75,350,name,cex=0.8,fill=rainbow(8),bg="white")
v1 <- data1[1:9,2]*0.1 # 강남구 값
v2 <- data1[1:9,3]*0.1 # 강동구 값
v3 <- data1[1:9,4]*0.1 # 강서구 값
v4 <- data1[1:9,5]*0.1 # 관악구 값
v5 <- data1[1:9,6]*0.1 # 구로구 값
v6 <- data1[1:9,7]*0.1 # 도봉구 값
v7 <- data1[1:9,8]*0.1 # 동대문구 값
v8 <- data1[1:9,9]*0.1 # 동작구 값
v9 <- data1[1:9,10]*0.1 # 마포구 값
v10 <- data1[1:9,11]*0.1 # 서대문구 값
par(mfrow=c(2,5))
gangnam <- barplot(as.matrix(v1),main="강남구 병원현황",
beside=T,axes=F,ylab="병원수(단위:10개)",xlab="", cex.names=0.85,
las=2, ylim=c(0,40), col=rainbow(8), border="white",names.arg=name)
axis(2,ylim=seq(0,35,10))
abline(h=seq(0,35,5),lty=2)
gangnam
gangnam
gangnam <- barplot(as.matrix(v1),main="강남구 병원현황",
beside=T,axes=F,ylab="병원수(단위:10개)",xlab="", cex.names=0.85,
las=2, ylim=c(0,40), col=rainbow(8), border="white",names.arg=name)
par(mfrow=c(1,1))
gangnam <- barplot(as.matrix(v1),main="강남구 병원현황",
beside=T,axes=F,ylab="병원수(단위:10개)",xlab="", cex.names=0.85,
las=2, ylim=c(0,40), col=rainbow(8), border="white",names.arg=name)
library(googleVis)
install.packages("googleVis")
library(googleVis)
data <- read.csv("2013년_서울_구별_주요과목별병원현황_구글용.csv",header=T)
data
hos <- gvisColumnChart(data,options=list(title="지역별 병원현황",
height=400,weight=500))
plot(hos)
?gvisColumnChart
data1
data <- read.csv("2013년_서울_구별_주요과목별병원현황_구글용utf8.csv",header=T)
data <- read.csv("2013년_서울_구별_주요과목별병원현황_구글용utf8.csv",header=T)
data <- read.csv("2013년_서울_구별_주요과목별병원현황_구글용utf8.csv",header=T)
data
hos <- gvisColumnChart(data,options=list(title="지역별 병원현황",
height=400,weight=500))
plot(hos)
